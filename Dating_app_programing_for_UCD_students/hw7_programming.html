<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Joël Porquet, PhD" />
  <title>ECS30: Homework #7 - Programming part</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
html {
font-size: 100%;
overflow-y: scroll;
-webkit-text-size-adjust: 100%;
-ms-text-size-adjust: 100%;
}
body {
color: #444;
font-family: 'Noto Serif', serif;
font-size: 10px;
line-height: 1.5em;
padding: 1em;
width: 960px;
margin: auto;
background: #fefefe;
position: relative;
}

.keyword{
position: absolute;
right: -15em;
width: 10em;
}

a {
color: #0645ad;
text-decoration: none;
}
a:visited {
color: #0b0080;
}
a:hover {
color: #06e;
}
a:active {
color: #faa700;
}
a:focus {
outline: thin dotted;
}

*::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
*::selection {
background: rgba(255, 255, 0, 0.3);
color: #000;
}
a::-moz-selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}
a::selection {
background: rgba(255, 255, 0, 0.3);
color: #0645ad;
}

p {
margin: 1em 0;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
color: #111;
line-height: 125%;
margin-top: 1em;
font-weight: normal;
}
h4, h5, h6 {
font-weight: bold;
}
h1 {
font-size: 2.5em;
}
h2 {
font-size: 2em;
}
h3 {
font-size: 1.5em;
}
h4 {
font-size: 1.2em;
}
h5 {
font-size: 1em;
}
h6 {
font-size: 0.9em;
}
blockquote {
color: #666666;
margin: 0;
padding-left: 3em;
border-left: 0.5em #EEE solid;
}
hr {
display: block;
height: 2px;
border: 0;
border-top: 1px solid #aaa;
border-bottom: 1px solid #eee;
margin: 1em 0;
padding: 0;
}
pre, code, kbd, samp {
color: #000;
background: #f0f0f0;
font-family: 'Noto Sans Mono', monospace;
font-size: 95%;
}
pre {
white-space: pre;
white-space: pre-wrap;
word-wrap: break-word;
}
b, strong {
font-weight: bold;
}
dfn {
font-style: italic;
}
ins {
background: #ff9;
color: #000;
text-decoration: none;
}
mark {
background: #ff0;
color: #000;
font-style: italic;
font-weight: bold;
}
sub, sup {
font-size: 75%;
line-height: 0;
position: relative;
vertical-align: baseline;
}
sup {
top: -0.5em;
}
sub {
bottom: -0.25em;
}
ul, ol {
margin: 1em 0;
padding: 0 0 0 2em;
}
li p:last-child {
margin-bottom: 0;
}
ul ul, ol ol {
margin: .3em 0;
}
dl {
margin-bottom: 1em;
}
dt {
font-weight: bold;
margin-bottom: .8em;
}
dd {
margin: 0 0 .8em 2em;
}
dd:last-child {
margin-bottom: 0;
}
img {
border: 0;
-ms-interpolation-mode: bicubic;
vertical-align: middle;
}
figure {
display: block;
text-align: center;
margin: 1em 0;
}
figure img {
border: none;
margin: 0 auto;
}
figcaption {
font-size: 0.8em;
font-style: italic;
margin: 0 0 .8em;
}

table {
margin-bottom: 2em;
border-bottom: 1px solid #ddd;
border-right: 1px solid #ddd;
border-spacing: 0;
border-collapse: collapse;
}
table th {
padding: .2em 1em;
background-color: #eee;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
}
table td {
padding: .2em 1em;
border-top: 1px solid #ddd;
border-left: 1px solid #ddd;
vertical-align: top;
}
.author {
font-size: 1.2em;

}

@media only screen and (min-width: 480px) {
body {
font-size: 14px;
}
}
@media only screen and (min-width: 768px) {
body {
font-size: 16px;
}
}
@media print {
* {
background: transparent !important;
color: black !important;
filter: none !important;
-ms-filter: none !important;
}
body {
font-size: 12pt;
max-width: 100%;
}
a, a:visited {
text-decoration: underline;
}
hr {
height: 1px;
border: 0;
border-bottom: 1px solid black;
}
a[href]:after {
content: " (" attr(href) ")";
}
abbr[title]:after {
content: " (" attr(title) ")";
}
.ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after {
content: "";
}
pre, blockquote {
border: 1px solid #999;
padding-right: 1em;
page-break-inside: avoid;
}
tr, img {
page-break-inside: avoid;
}
img {
max-width: 100% !important;
}
@page :left {
margin: 15mm 20mm 15mm 10mm;
}
@page :right {
margin: 15mm 10mm 15mm 20mm;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3 {
page-break-after: avoid;
}
}
</style>
  <style type="text/css">.hll { background-color: #ffffcc }
.c { color: #408080; font-style: italic } 
.err { border: 1px solid #FF0000 } 
.k { color: #008000; font-weight: bold } 
.o { color: #666666 } 
.ch { color: #408080; font-style: italic } 
.cm { color: #408080; font-style: italic } 
.cp { color: #BC7A00 } 
.cpf { color: #408080; font-style: italic } 
.c1 { color: #408080; font-style: italic } 
.cs { color: #408080; font-style: italic } 
.gd { color: #A00000 } 
.ge { font-style: italic } 
.gr { color: #FF0000 } 
.gh { color: #000080; font-weight: bold } 
.gi { color: #00A000 } 
.go { color: #888888 } 
.gp { color: #000080; font-weight: bold } 
.gs { font-weight: bold } 
.gu { color: #800080; font-weight: bold } 
.gt { color: #0044DD } 
.kc { color: #008000; font-weight: bold } 
.kd { color: #008000; font-weight: bold } 
.kn { color: #008000; font-weight: bold } 
.kp { color: #008000 } 
.kr { color: #008000; font-weight: bold } 
.kt { color: #B00040 } 
.m { color: #666666 } 
.s { color: #BA2121 } 
.na { color: #7D9029 } 
.nb { color: #008000 } 
.nc { color: #0000FF; font-weight: bold } 
.no { color: #880000 } 
.nd { color: #AA22FF } 
.ni { color: #999999; font-weight: bold } 
.ne { color: #D2413A; font-weight: bold } 
.nf { color: #0000FF } 
.nl { color: #A0A000 } 
.nn { color: #0000FF; font-weight: bold } 
.nt { color: #008000; font-weight: bold } 
.nv { color: #19177C } 
.ow { color: #AA22FF; font-weight: bold } 
.w { color: #bbbbbb } 
.mb { color: #666666 } 
.mf { color: #666666 } 
.mh { color: #666666 } 
.mi { color: #666666 } 
.mo { color: #666666 } 
.sa { color: #BA2121 } 
.sb { color: #BA2121 } 
.sc { color: #BA2121 } 
.dl { color: #BA2121 } 
.sd { color: #BA2121; font-style: italic } 
.s2 { color: #BA2121 } 
.se { color: #BB6622; font-weight: bold } 
.sh { color: #BA2121 } 
.si { color: #BB6688; font-weight: bold } 
.sx { color: #008000 } 
.sr { color: #BB6688 } 
.s1 { color: #BA2121 } 
.ss { color: #19177C } 
.bp { color: #008000 } 
.fm { color: #0000FF } 
.vc { color: #19177C } 
.vg { color: #19177C } 
.vi { color: #19177C } 
.vm { color: #19177C } 
.il { color: #666666 } 
</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">ECS30: Homework #7 - Programming part</h1>
<p class="author">Joël Porquet, PhD</p>
<p class="date">UC Davis, Spring 2018</p>
</header>
<nav id="TOC">
<ul>
<li><a href="#changelog"><span class="toc-section-number">1</span> Changelog</a></li>
<li><a href="#general-information"><span class="toc-section-number">2</span> General information</a></li>
<li><a href="#introduction"><span class="toc-section-number">3</span> Introduction</a></li>
<li><a href="#programming-exercises"><span class="toc-section-number">4</span> Programming exercises</a></li>
</ul>
</nav>
<h1 id="changelog"><span class="header-section-number">1</span> Changelog</h1>
<ul>
<li>v3: fix name of program</li>
<li>v2: Update contents of database.txt in execution trace</li>
<li>v1: First publication</li>
</ul>
<h1 id="general-information"><span class="header-section-number">2</span> General information</h1>
<ul>
<li>Due before <strong>11:59 PM, Thursday June 7th, 2018</strong></li>
<li>You are to work alone for this homework</li>
<li>The reference work environment is the CSIF</li>
</ul>
<h1 id="introduction"><span class="header-section-number">3</span> Introduction</h1>
<h2 id="reference-executables"><span class="header-section-number">3.1</span> Reference executables</h2>
<p>Working executables for all the following problems are available on the CSIF class account, in directory <code>/home/cs30/public/hw7</code>.</p>
<h1 id="programming-exercises"><span class="header-section-number">4</span> Programming exercises</h1>
<h2 id="ucupid"><span class="header-section-number">4.1</span> UCupiD</h2>
<p>A group of sociology students have had the idea of creating a dating application for UC Davis, and even found a name: <strong>UCupiD</strong>. However, none of them know how to program and they need help implementing their idea.</p>
<p>A file database has an entry for each individual who has subscribed to the service. Each entry contains the individual’s SID number (9 digits), first name (&lt; 20 characters), sex (M or F), sexual orientation (M or F), age, political leaning (from 0 for very conservative, up to 10 for very liberal), major hobby (&lt; 20 characters), minor hobby (&lt; 20 characters), height (in inches) and weight (in pounds). Entries are ordered by SID numbers.</p>
<p>Two individuals match if their respective sex and sexual orientation are compatible (e.g. a female looking for males would be compatible with a male looking for females, or a male looking for males would be compatible another male looking for males, etc.) and if one of the following matching criteria is triggered:</p>
<ol type="1">
<li><p><em>Social identity</em>: the two individuals are within 10 years of each other and have a political leaning within 2 points of each other.</p></li>
<li><p><em>Personality</em>: the two individuals share both their major and minor hobbies.</p></li>
<li><p><em>Appearance</em>: the two individuals are within 10% of each other’s height and weight.</p></li>
</ol>
<p>Write program <code>UCupiD.c</code> which receives as program arguments the name of the database file and an individual’s SID, and generates an output file containing the list of possible matches for this individual, ordered by their SID, as illustrated in the following example.</p>
<div class="highlight"><pre><span></span><span class="gp">$</span> cat database.txt
<span class="go">111223333,Rob,M,F,47,5,Dancing,Painting,63,165</span>
<span class="go">123456789,Bob,M,F,77,2,Baseball,Cooking,72,275</span>
<span class="go">194783218,Ann,F,M,28,9,Dancing,Painting,65,125</span>
<span class="go">222334444,Barbara,F,M,40,4,Jogging,Movies,64,145</span>
<span class="go">222334567,John,M,M,45,7,Cooking,Hiking,70,182</span>
<span class="go">555446767,Joan,F,M,69,1,Organizing,Writing,59,115</span>
<span class="go">622555555,Drewbert,M,M,59,6,Organizing,Fishing,68,170</span>
<span class="go">823810924,Andrew,M,F,25,4,Dancing,Painting,84,280</span>
<span class="go">622555556,Zeta,F,F,34,8,Organizing,Fishing,68,170</span>
<span class="go">823810925,Fran,F,F,25,10,Dancing,Painting,84,280</span>
<span class="go">847111411,Adam,M,M,82,7,Theatre,Sparring,72,200</span>
<span class="go">999999999,Aerith,F,M,22,1,Gardening,Cooking,63,100</span>
<span class="gp">$</span> ./UCupiD database.txt <span class="m">111223333</span>
<span class="gp">$</span> cat match_111223333.txt
<span class="go">Matches for user 111223333 (Rob):</span>
<span class="go">- 194783218 (Ann)</span>
<span class="go">- 222334444 (Barbara)</span>
<span class="gp">$</span> ./UCupiD database.txt <span class="m">622555556</span>
<span class="gp">$</span> cat match_622555556.txt
<span class="go">Matches for user 622555556 (Zeta):</span>
<span class="go">- 823810925 (Fran)</span>
<span class="gp">$</span> ./UCupiD database.txt <span class="m">000000000</span>
<span class="go">User with SID 000000000 not found</span>
<span class="gp">$</span> ./UCupiD wrong_file.txt <span class="m">000000000</span>
<span class="go">Error: cannot open wrong_file.txt</span>
<span class="gp">$</span> ./UCupiD
<span class="go">Usage: ./UCupiD db_file SID</span>
<span class="gp">$</span> <span class="nb">echo</span> <span class="nv">$?</span>
<span class="go">1</span>
<span class="gp">$</span>
</pre></div>

<p>Here are a list of requirements, assumptions and hints:</p>
<ul>
<li><p>The program should receive two command-line arguments, the name of the database file and an individual’s SID. If less than two arguments are provided, the program should display an error message and return with error code <code>1</code>.</p>
<ul>
<li>Other errors include: database file cannot be opened, individual cannot be found in database, output file cannot be created and opened.</li>
</ul></li>
<li><p>The name of the output file must be generated based on the individual’s SID for which the program is trying to find matches: <code>match_&lt;SID&gt;.txt</code>.</p></li>
<li><p>The database file is formatted in <code>csv</code>, which means that each individual’s entry is described on one line, and the information within each line are separated by commas. The format for an entry is:</p>
<div class="highlight"><pre><span></span>SID,Firstname,Sex,Orientation,Age,PoliticalLeaning,MajorHobby,MinorHobby,Height,Weight
</pre></div>

<p>For reading the file, it is recommended to use <code>fgets()</code> to read an entire line (we assume that the maximum amount of characters per line is 256) and <code>sscanf()</code> to parse the entry and retrieve each of the individual’s information.</p>
<p>Because commas are not considered as a word delimiter by <code>sscanf()</code> when using <code>%s</code>, we need to use string specifier <code>%[^,]</code>. This specifier will match all the characters until encountering a comma. Here an example code:</p>
<div class="highlight"><pre><span></span><span class="kt">char</span> <span class="o">*</span><span class="n">entry</span> <span class="o">=</span> <span class="s">&quot;Homer,45&quot;</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
<span class="n">sscanf</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="s">&quot;%[^,]&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>             <span class="cm">/* Will print 'Homer' */</span>
</pre></div>
</li>
<li><p>When reading the database file, you have to create a linked list to represent individuals in your program.</p>
<p><strong>IMPORTANT</strong>: Not using a linked list will result in getting a straight zero for the <em>Implementation</em> score on Gradescope.</p></li>
<li><p>Here is the suggested order of implementation for this program:</p>
<ol type="1">
<li><p>Define a structure that represents each individual.</p></li>
<li><p>Write a function that reads each entry from the database file, and creates a structure object that is inserted in a linked list of individuals.</p></li>
<li><p>Write a function that finds an individual in the linked list based on their SID.</p></li>
<li><p>Write a function that finds all the matches between an individual and all of the individuals represented in the linked list, and outputs the matches in a file.</p></li>
<li><p>Write a function that destroy the linked list.</p></li>
<li><p>Write the <code>main()</code> function which receives the command-line arguments and then calls all the functions above in the appropriate order.</p></li>
</ol></li>
<li><p>List of some important libc functions that are used in the reference program: <code>fopen()</code>, <code>fclose()</code>, <code>fgets()</code>, <code>sscanf()</code>, <code>malloc()</code>, <code>free()</code>, <code>strcmp()</code>, <code>sprintf()</code>, <code>abs()</code>.</p></li>
</ul>
</body>
</html>
